{% extends 'base.html' %}
{% load i18n %}
{% load crispy_forms_tags %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold">{% translate "Item Translations" %}</h1>
        <a href="{% url 'translations_dashboard' %}" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">
            {% translate "Back to Dashboard" %}
        </a>
    </div>

    <!-- Search and Filter Form -->
    <div class="mb-6">
        <form hx-get="{% url 'item_translation_list' %}" 
              hx-target="#translation-table" 
              hx-swap="innerHTML"
              hx-trigger="submit, change from:select, keyup[target.name=='search'] changed delay:500ms">
            <div class="flex flex-col md:flex-row gap-4 mb-4">
                <div class="w-full md:w-2/3">
                    <label class="block text-sm font-medium text-gray-700 mb-2">{% translate "Search" %}</label>
                    <input type="text" 
                           name="search" 
                           value="{{ current_search }}"
                           placeholder="{% translate 'Search items...' %}"
                           class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="w-full md:w-1/3">
                    <label class="block text-sm font-medium text-gray-700 mb-2">{% translate "Language Filter" %}</label>
                    <select name="language_filter" 
                            class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">{% translate "All Languages" %}</option>
                        {% for lang_code, lang_name in available_languages %}
                            <option value="{{ lang_code }}_translated" 
                                    {% if current_language_filter == lang_code|add:"_translated" %}selected{% endif %}>
                                {{ lang_name }} ({% translate "Translated" %})
                            </option>
                            <option value="{{ lang_code }}_untranslated" 
                                    {% if current_language_filter == lang_code|add:"_untranslated" %}selected{% endif %}>
                                {{ lang_name }} ({% translate "Not Translated" %})
                            </option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </form>
    </div>

    <!-- Items Table -->
    <div id="translation-table">
        {% include 'promapp/partials/item_translation_list_table.html' %}
    </div>
</div>
{% endblock %}
