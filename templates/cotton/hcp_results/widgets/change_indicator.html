<c-vars
    current_score
    previous_score
    direction
    show_values="False"
/>

{% if previous_score and previous_score.score is not None %}
    {% if current_score == previous_score.score %}
        <!-- No change -->
        <div class="flex items-center text-gray-500 text-sm">
            <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                <rect x="3" y="9" width="14" height="2" rx="1"/>
            </svg>
            <span>No change</span>
            {% if show_values %}
                <span class="ml-1">({{ previous_score.score }})</span>
            {% endif %}
        </div>
    {% else %}
        {% comment %}Determine if change is improvement or worsening{% endcomment %}
        {% if direction == "Higher is Better" %}
            {% if current_score > previous_score.score %}
                <!-- Improvement (green up arrow) -->
                <div class="flex items-center text-green-600 text-sm">
                    <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 3a1 1 0 01.707.293l7 7a1 1 0 01-1.414 1.414L10 5.414 3.707 11.707a1 1 0 01-1.414-1.414l7-7A1 1 0 0110 3z" clip-rule="evenodd"/>
                    </svg>
                    <span>Improved</span>
                    {% if show_values %}
                        <span class="ml-1">(+{{ current_score|floatformat:1|sub:previous_score.score|floatformat:1 }})</span>
                    {% endif %}
                </div>
            {% else %}
                <!-- Worsening (orange down arrow) -->
                <div class="flex items-center text-orange-500 text-sm">
                    <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 17a1 1 0 01-.707-.293l-7-7a1 1 0 011.414-1.414L10 14.586l6.293-6.293a1 1 0 011.414 1.414l-7 7A1 1 0 0110 17z" clip-rule="evenodd"/>
                    </svg>
                    <span>Worsened</span>
                    {% if show_values %}
                        <span class="ml-1">({{ current_score|floatformat:1|sub:previous_score.score|floatformat:1 }})</span>
                    {% endif %}
                </div>
            {% endif %}
        {% elif direction == "Lower is Better" %}
            {% if current_score < previous_score.score %}
                <!-- Improvement (green down arrow) -->
                <div class="flex items-center text-green-600 text-sm">
                    <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 17a1 1 0 01-.707-.293l-7-7a1 1 0 011.414-1.414L10 14.586l6.293-6.293a1 1 0 011.414 1.414l-7 7A1 1 0 0110 17z" clip-rule="evenodd"/>
                    </svg>
                    <span>Improved</span>
                    {% if show_values %}
                        <span class="ml-1">({{ current_score|floatformat:1|sub:previous_score.score|floatformat:1 }})</span>
                    {% endif %}
                </div>
            {% else %}
                <!-- Worsening (orange up arrow) -->
                <div class="flex items-center text-orange-500 text-sm">
                    <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 3a1 1 0 01.707.293l7 7a1 1 0 01-1.414 1.414L10 5.414 3.707 11.707a1 1 0 01-1.414-1.414l7-7A1 1 0 0110 3z" clip-rule="evenodd"/>
                    </svg>
                    <span>Worsened</span>
                    {% if show_values %}
                        <span class="ml-1">(+{{ current_score|floatformat:1|sub:previous_score.score|floatformat:1 }})</span>
                    {% endif %}
                </div>
            {% endif %}
        {% else %}
            <!-- No direction specified - just show previous value -->
            <div class="flex items-center text-gray-500 text-sm">
                <span>Previous: {{ previous_score.score|floatformat:1 }}</span>
            </div>
        {% endif %}
    {% endif %}
{% elif previous_score %}
    <!-- Previous score exists but was missing -->
    <div class="flex items-center text-gray-400 text-sm">
        <span>Previous: -NA-</span>
    </div>
{% else %}
    <!-- No previous score available -->
    <div class="flex items-center text-gray-400 text-sm">
        <span>First submission</span>
    </div>
{% endif %} 